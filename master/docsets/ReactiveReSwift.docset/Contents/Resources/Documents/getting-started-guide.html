<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Getting Started Guide  Reference</title>
    <link rel='stylesheet' type='text/css' href='css/jazzy.css' />
    <link rel='stylesheet' type='text/css' href='css/highlight.css' />
    <meta charset='utf-8'>
    <script src='js/jquery.min.js' defer></script>
    <script src='js/jazzy.js' defer></script>
  </head>
  <body>


    <a title='Getting Started Guide  Reference'></a>

    <header class='header'>
      <p class='header-col header-col--primary'>
        <a class='header-link' href='index.html'>
          ReactiveReSwift Docs
        </a>
         (75% documented)
      </p>
    
        <p class='header-col header-col--secondary'>
          <a class='header-link' href='https://github.com/ReSwift/ReactiveReSwift'>
            <img class='header-icon' src='img/gh.png'/>
            View on GitHub
          </a>
        </p>
    
        <p class='header-col header-col--secondary'>
          <a class='header-link' href='dash-feed://http%3A%2F%2FReSwift%2Egithub%2Eio%2FReactiveReSwift%2Fmaster%2Fdocsets%2FReactiveReSwift%2Exml'>
            <img class='header-icon' src='img/dash.png'/>
            Install in Dash
          </a>
        </p>
    </header>

    <p class='breadcrumbs'>
      <a class='breadcrumb' href='index.html'>ReactiveReSwift Reference</a>
      <img class='carat' src='img/carat.png' />
      Getting Started Guide  Reference
    </p>

    <div class='content-wrapper'>
      <nav class='navigation'>
        <ul class='nav-groups'>
          <li class='nav-group-name'>
            <a class='nav-group-name-link' href='Documentation.html'>Documentation</a>
            <ul class='nav-group-tasks'>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='about-reactivereswift.html'>About ReactiveReSwift</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='why-reactivereswift.html'>Why ReactiveReSwift</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='getting-started-guide.html'>Getting Started Guide</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='installation.html'>Installation</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='reactive-extensions.html'>Reactive Extensions</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='example-projects.html'>Example Projects</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='contributing.html'>Contributing</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='credits.html'>Credits</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='get-in-touch.html'>Get in touch</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='changelog.html'>Changelog</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='license.html'>License</a>
              </li>
            </ul>
          </li>
          <li class='nav-group-name'>
            <a class='nav-group-name-link' href='Core.html'>Core</a>
            <ul class='nav-group-tasks'>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Classes/Store.html'>Store</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Core.html#/s:P15ReactiveReSwift9StateType'>StateType</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Core.html#/s:P15ReactiveReSwift6Action'>Action</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Structs/Reducer.html'>Reducer</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Structs/Middleware.html'>Middleware</a>
              </li>
            </ul>
          </li>
          <li class='nav-group-name'>
            <a class='nav-group-name-link' href='Reactive.html'>Reactive</a>
            <ul class='nav-group-tasks'>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Protocols/StreamType.html'>StreamType</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Protocols/ObservablePropertyType.html'>ObservablePropertyType</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Protocols/SubscriptionReferenceType.html'>SubscriptionReferenceType</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Classes/ObservableProperty.html'>ObservableProperty</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Structs/ObservablePropertySubscriptionReference.html'>ObservablePropertySubscriptionReference</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Classes/SubscriptionReferenceBag.html'>SubscriptionReferenceBag</a>
              </li>
            </ul>
          </li>
          <li class='nav-group-name'>
            <a class='nav-group-name-link' href='Other Protocols.html'>Other Protocols</a>
            <ul class='nav-group-tasks'>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Protocols/Coding.html'>Coding</a>
              </li>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Protocols/StandardActionConvertible.html'>StandardActionConvertible</a>
              </li>
            </ul>
          </li>
          <li class='nav-group-name'>
            <a class='nav-group-name-link' href='Other Structs.html'>Other Structs</a>
            <ul class='nav-group-tasks'>
              <li class='nav-group-task'>
                <a class='nav-group-task-link' href='Structs/StandardAction.html'>StandardAction</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class='main-content'>

        <section class='section'>
          <div class='section-content'>
            
            <a href='#getting-started-with-reactivereswift' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='getting-started-with-reactivereswift'>Getting Started with ReactiveReSwift</h1>

<p>ReactiveReSwift provides the infrastructure for <code>Store</code>s, <code>Action</code>s and <code>Reducer</code>s to enable a unidirectional data flow as shown below.</p>

<p><img src="img/reactivereswift_concept.png" alt=""></p>

<p>The following steps will describe how to set up the individual components for your ReactiveReSwift app.</p>
<a href='#state' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='state'>State</h1>

<p>The application state is defined in a single data structure which should be a struct. This struct can have other structs as members, that allows you to add different sub-states as your app grows.</p>

<p>The state struct should store your entire application state, that includes the UI state, the navigation state and the state of your model layer.</p>

<p>Here&rsquo;s an example of a state struct as defined in the <a href="https://github.com/Qata/ReactiveCounterExample">Reactive Counter Example</a>:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">AppState</span><span class="p">:</span> <span class="kt">StateType</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">counter</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">}</span>
</code></pre>

<p>Your app state struct needs to conform to the <code>StateType</code> protocol, this is just a marker protocol.</p>
<a href='#derived-state' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='derived-state'>Derived State</h2>

<p>Note that you don&rsquo;t need to store derived state inside of your app state. E.g. instead of storing a <code>UIImage</code> you should store a image URL that can be used to fetch the image from a cache or via a download. The app state should store all the information that uniquely identifies the current state and allows it to be reconstructed, but none that can be easily derived.</p>
<a href='#actions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='actions'>Actions</h1>

<p>Actions are used to express intended state changes. Actions don&rsquo;t contain functions, instead they provide information about the intended state change, e.g. which user should be deleted.</p>

<p>In your ReactiveReSwift app you will define actions for every possible state change that can happen.</p>

<p>Reducers handle these actions and implement state changes based on the information the actions provide.</p>

<p>All actions in ReactiveReSwift conform to the <code>Action</code> protocol.</p>

<p>You will need to provide custom types for actions. We recommend using an enum for actions that have similar goals (e.g. increasing and decreasing a value). If an action is completely independent from the rest of your actions, using a struct might work better.</p>

<p>To provide your own action, simply create a type that conforms to the <code>Action</code> protocol:</p>
<pre class="highlight swift"><code><span class="kd">enum</span> <span class="kt">ModifyCountAction</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">increase</span>
    <span class="k">case</span> <span class="n">decrease</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">LikePostAction</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">post</span><span class="p">:</span> <span class="kt">Post</span>
    <span class="k">let</span> <span class="nv">userLikingPost</span><span class="p">:</span> <span class="kt">User</span>
<span class="p">}</span>
</code></pre>
<a href='#reducers' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='reducers'>Reducers</h1>

<p>Reducers are the only place in which you should modify application state! Reducers take the current application state and an action and return the new transformed application state. We recommend to provide many small reducers that each handle a subset of your application state.</p>

<p>You can do this implementing a top-level reducer. This reducer will then call individual functions for each different part of the app state.</p>

<p>Here&rsquo;s an example in which we construct a new state, by calling sub-reducers with different sub-states:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">appReducer</span> <span class="o">=</span> <span class="kt">Reducer</span><span class="p">(</span><span class="n">authenticationReducer</span><span class="p">,</span> <span class="n">bookmarksReducer</span><span class="p">,</span> <span class="n">repositoriesReducer</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">authenticationReducer</span> <span class="o">=</span> <span class="kt">Reducer</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">action</span><span class="p">,</span> <span class="n">state</span> <span class="k">in</span>
    <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">state</span>

    <span class="k">switch</span> <span class="n">action</span> <span class="p">{</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">action</span> <span class="k">as</span> <span class="kt">SetOAuthURL</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">authenticationState</span><span class="o">.</span><span class="n">oAuthURL</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">oAuthUrl</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">action</span> <span class="k">as</span> <span class="kt">UpdateLoggedInState</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">authenticationState</span><span class="o">.</span><span class="n">loggedInState</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">loggedInState</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">state</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">bookmarksReducer</span> <span class="o">=</span> <span class="kt">Reducer</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">action</span><span class="p">,</span> <span class="n">state</span> <span class="k">in</span>
    <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">state</span>

    <span class="k">if</span> <span class="k">let</span> <span class="nv">action</span> <span class="o">=</span> <span class="n">action</span> <span class="k">as?</span> <span class="kt">CreateBookmark</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">bookmark</span> <span class="o">=</span> <span class="p">(</span><span class="nv">route</span><span class="p">:</span> <span class="n">action</span><span class="o">.</span><span class="n">route</span><span class="p">,</span> <span class="nv">routeSpecificData</span><span class="p">:</span> <span class="n">action</span><span class="o">.</span><span class="n">routeSpecificData</span><span class="p">)</span>
        <span class="n">state</span><span class="o">.</span><span class="n">bookmarks</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">bookmark</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">state</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">repositoriesReducer</span> <span class="o">=</span> <span class="kt">Reducer</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">action</span><span class="p">,</span> <span class="n">state</span> <span class="k">in</span>
    <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">state</span>

    <span class="k">if</span> <span class="k">let</span> <span class="nv">action</span> <span class="o">=</span> <span class="n">action</span> <span class="k">as?</span> <span class="kt">SetRepostories</span> <span class="p">{</span>
        <span class="n">state</span><span class="o">.</span><span class="n">repositories</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">repositories</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">state</span>
<span class="p">}</span>
</code></pre>

<p>The <code>Reducer</code> struct has an init that takes a function that expects an <code>Action</code> and an <code>State</code> and returns a <code>State</code>. In the example above the <code>appReducer</code> deals with reducing . E.g. the <code>authenticationReducer</code> is responsible for providing the <code>authenticationState</code>.</p>

<p>You can see that the <code>authenticationReducer</code> function is a free function. You can define it with any arbitrary method signature, but we recommend that it matches the method in the <code>Reducer</code> protocol (current state and action in, new state out).</p>

<p>The sub reducers switch over the provided <code>action</code> and checks its type. Depending on the type of action, this reducer will updated the state differently. These specific reducers are very simple, each action only triggers a single property of the state to update.</p>

<p>Once the state update is complete, the reducer function returns the new state.</p>

<p>After <code>appReducer</code> has called all of its sub reducers, we have a new application state. <code>ReactiveReSwift</code> will take care of publishing this new state to all subscribers.</p>
<a href='#store-subscriptions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='store-subscriptions'>Store Subscriptions</h1>

<p><strong><em>The following instructions only apply if you don&rsquo;t use a third party FRP library with ReactiveReSwift, which we highly recommend you do</em></strong>
To subscribe to the store a method needs to call <code>subscibe(_:)</code> on <code>Store.observable</code> and keep a reference to its <code>SubsciptionReference</code> (unless it&rsquo;s a class guaranteed to always exist) .</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">disposable</span> <span class="o">=</span> <span class="n">mainStore</span><span class="o">.</span><span class="n">observable</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">store</span> <span class="k">in</span>
    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">counterLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Most of your <code>StoreSubscriber</code>s will be in the view layer and update their representation whenever they receive a new state.</p>
<a href='#example-with-filtered-subscriptions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='example-with-filtered-subscriptions'>Example With Filtered Subscriptions</h2>

<p>Ideally most of our subscribers should only be interested in a very small portion of the overall app state. <code>ReactiveReSwift</code> provides a way to subselect the relevant state for a particular subscriber at the point of subscription. Here&rsquo;s an example of subscribing, filtering and unsubscribing as used within a view controller:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">disposeBag</span> <span class="o">=</span> <span class="kt">SubscriptionReferenceBag</span><span class="p">()</span>

<span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">(</span><span class="n">animated</span><span class="p">)</span>

    <span class="c1">// subscribe when VC loads</span>
    <span class="n">disposeBag</span> <span class="o">+=</span> <span class="n">store</span><span class="o">.</span><span class="n">observable</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">store</span> <span class="k">in</span>
        <span class="k">if</span> <span class="k">case</span> <span class="o">.</span><span class="kt">Success</span><span class="p">(</span><span class="k">let</span> <span class="nv">repositories</span><span class="p">)</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">repositories</span> <span class="p">{</span>
            <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">dataSource</span><span class="p">?</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">repositories</span>
            <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">tableView</span><span class="o">.</span><span class="nf">reloadData</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>In the example above we only select a single property from the overall application state: a network <code>Response</code> with a list of repositories.</p>

<p>When subscribing within a ViewController you will typically update the view from within the <code>subscribe</code> block.</p>
<a href='#beyond-the-basics' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='beyond-the-basics'>Beyond the Basics</h1>
<a href='#asynchronous-operations' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='asynchronous-operations'>Asynchronous Operations</h2>

<p>Conceptually asynchronous operations can simply be treated as state updates that occur at a later point in time. Here&rsquo;s a simple example of how to tie an asynchronous network request to <code>ReactiveReSwift</code> state update:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">fetchGitHubRepositories</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">State</span><span class="p">,</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">case</span> <span class="o">.</span><span class="kt">LoggedIn</span><span class="p">(</span><span class="k">let</span> <span class="nv">configuration</span><span class="p">)</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">authenticationState</span><span class="o">.</span><span class="n">loggedInState</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

    <span class="k">let</span> <span class="nv">promise</span> <span class="o">=</span> <span class="kt">PromiseKit</span><span class="o">.</span><span class="n">wrap</span> <span class="p">{</span> <span class="n">resolve</span> <span class="k">in</span>
        <span class="kt">Octokit</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span><span class="o">.</span><span class="nf">repositories</span><span class="p">(</span><span class="n">resolve</span><span class="p">)</span>
    <span class="p">}</span><span class="o">.</span><span class="n">then</span> <span class="p">{</span>
        <span class="kt">SetRepostories</span><span class="p">(</span><span class="nv">repositories</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">store</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="n">promise</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>In this example we&rsquo;re using the <code>Octokit</code> and <code>PromiseKit</code> libraries to perform a network request that fetches a user&rsquo;s repositories. We then convert that request to a <code>Promise</code> that&rsquo;s conformed to <code>StreamType</code> and dispatch that promise into the store (the store will subscribe to that promise and dispatch the returned ). This will trigger all subscribers to be informed about the new state.</p>

<p>In many cases your asynchronous tasks will consist of two separate steps:</p>

<ol>
<li>Update UI to show a loading indicator</li>
<li>Refresh the UI once data arrived</li>
</ol>

<p>You can extend the example above, by dispatching a separate action, as soon as the network request starts. The goal of that action is to trigger the UI to update &amp; show a loading indicator.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">fetchGitHubRepositories</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">State</span><span class="p">,</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="kt">LoggedIn</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">authenticationState</span><span class="o">.</span><span class="n">loggedInState</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

    <span class="n">store</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="kt">SetRepositories</span><span class="p">(</span><span class="nv">repositories</span><span class="p">:</span> <span class="o">.</span><span class="kt">Loading</span><span class="p">))</span>

    <span class="k">let</span> <span class="nv">promise</span> <span class="o">=</span> <span class="kt">PromiseKit</span><span class="o">.</span><span class="n">wrap</span> <span class="p">{</span> <span class="n">resolve</span> <span class="k">in</span>
        <span class="kt">Octokit</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span><span class="o">.</span><span class="nf">repositories</span><span class="p">(</span><span class="n">resolve</span><span class="p">)</span>
    <span class="p">}</span><span class="o">.</span><span class="n">then</span> <span class="p">{</span>
        <span class="kt">SetRepostories</span><span class="p">(</span><span class="nv">repositories</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">store</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="n">promise</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>In the example above, we&rsquo;re using an <code>enum</code> to represent the different states of a single state slice that depends on a network request (e.g. loading, result available, network request failed). There are many different ways to model states of a network request but it will mostly involve using multiple dispatched actions at different stages of your network requests.</p>
<a href='#middleware' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='middleware'>Middleware</h2>

<p>ReactiveReSwift supports middleware in the same way as Redux does, <a href="http://redux.js.org/docs/advanced/Middleware.html">you can read this great documentation on Redux middleware to get started</a>. Middleware allows developers to provide extensions that wrap the <code>dispatch</code> function.</p>

<p>Let&rsquo;s take a look at a quick example that shows how ReactiveReSwift supports Redux style middleware.</p>

<p>The simplest example of a middleware, is one that prints all actions to the console. Here&rsquo;s how you can implement it:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">loggingMiddleware</span> <span class="o">=</span> <span class="kt">Middleware</span><span class="o">&lt;</span><span class="kt">State</span><span class="o">&gt;</span><span class="p">()</span><span class="o">.</span><span class="n">sideEffect</span> <span class="p">{</span> <span class="n">getState</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">,</span> <span class="n">action</span> <span class="k">in</span>
    <span class="c1">// perform middleware logic</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>You can define which middleware you would like to use when creating your store:</p>
<pre class="highlight swift"><code><span class="kt">Store</span><span class="p">(</span>
    <span class="nv">reducer</span><span class="p">:</span> <span class="n">appReducer</span><span class="p">,</span>
    <span class="nv">stateType</span><span class="p">:</span> <span class="kt">TestStringAppState</span><span class="o">.</span><span class="k">self</span><span class="p">,</span>
    <span class="nv">observable</span><span class="p">:</span> <span class="kt">ObservableProperty</span><span class="p">(</span><span class="kt">TestStringAppState</span><span class="p">()),</span>
    <span class="nv">middleware</span><span class="p">:</span> <span class="kt">Middleware</span><span class="p">(</span><span class="n">loggingMiddleware</span><span class="p">,</span> <span class="n">secondMiddleware</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>

<p>The actions will pass through the middleware in the order in which they are arranged in the <code>Middleware</code> initializer, however ideally middleware should not make any assumptions about when exactly it is called.</p>

<p><code>Middleware</code> supports multiple different operations.</p>

<p>In no particular order, some of the more important operations are:</p>

<ul>
<li><code>sideEffect(_:)</code> Gives access to the <code>dispatch(_:)</code> function. Does not return, to ensure that only side effects reside inside.</li>
<li><code>filter(_:)</code> If the predicate function passed to filter passes, keep the action, otherwise discard the action.</li>
<li><code>map(_:)</code> Apply a transformative function to the action.</li>
<li><code>flatMap(_:)</code> Essentially a <code>map</code> that can also filter out the action by returning <code>nil</code></li>
</ul>

          </div>
        </section>


      </article>
    </div>
    <section class='footer'>
      <p>© 2016 <a class="link" href="https://github.com/ReSwift/ReSwift" target="_blank" rel="external">ReSwift</a>. All rights reserved.</p>
      <p>Generated by <a class='link' href='https://github.com/realm/jazzy' target='_blank' rel='external'>jazzy ♪♫ v0.7.4</a>, a <a class='link' href='http://realm.io' target='_blank' rel='external'>Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
